"use strict";(self["webpackChunkvue_workbase_app"]=self["webpackChunkvue_workbase_app"]||[]).push([[558],{69826:function(e,n,r){var t=r(82109),u=r(42092).find,a=r(51223),i="find",l=!0;i in[]&&Array(1)[i]((function(){l=!1})),t({target:"Array",proto:!0,forced:l},{find:function(e){return u(this,e,arguments.length>1?arguments[1]:void 0)}}),a(i)},43678:function(e,n,r){r.d(n,{FO:function(){return a},Jp:function(){return o},Ue:function(){return i},Vx:function(){return l},nY:function(){return c},ts:function(){return s}});r(50124),r(48534);var t=r(4648),u=r(38042),a=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return u.Z.get("crazy/freelancer/v1.0.1/orders/".concat(e),(0,t.Z)({params:n},r))},i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{services:services},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u.Z.post("crazy/freelancer/v1.0.1/orders",e,n)},l=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{services:services,name:name,address:address,lat:lat,lng:lng,is_online:is_online,at_customer:at_customer,at_executor:at_executor},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return u.Z.post("crazy/freelancer/v1.0.1/orders/".concat(e),n,r)},o=function(e,n,r){return u.Z["delete"]("crazy/freelancer/v1.0.1/orders/".concat(e),(0,t.Z)({params:n},r))},c=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return u.Z.post("crazy/freelancer/v1.0.1/orders/".concat(e,"/publish"),n,r)},s=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return u.Z.post("crazy/freelancer/v1.0.1/orders/".concat(e,"/replies"),n,r)}},79166:function(e,n,r){r.d(n,{Ql:function(){return i},U2:function(){return a},Ue:function(){return l}});var t=r(4648),u=r(38042),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{with:[],category:null,page:1,perPage:10},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u.Z.get("crazy/freelancer/v1.0.1/services",(0,t.Z)({params:e},n))},i=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{with:[],count:[]},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return u.Z.get("crazy/freelancer/v1.0.1/services/".concat(e),(0,t.Z)({params:n},r))},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"",parent:null,category:null},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u.Z.post("crazy/freelancer/v1.0.1/services",e,n)}},1875:function(e,n,r){r.d(n,{Z:function(){return v}});var t=r(50124),u=r(48534),a=(r(41539),r(59063)),i=r(2262),l=r(66252),o=(0,i.qj)({id:null,name:null,slug:null,excerpt:null,description:null,priority_services:[],services:[],image:null}),c=(0,i.iH)(!1),s=(0,i.iH)(null);function v(){var e=(0,l.Fl)((function(){return!!o.slug})),n=function(){var e=(0,u.Z)((0,t.Z)().mark((function e(n){var r,u=arguments;return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=u.length>1&&void 0!==u[1]?u[1]:{with:[]},Object.assign(o,{id:null,name:null,slug:null,excerpt:null,description:null,priority_services:[],services:[],image:null}),c.value=!0,s.value=(0,a.Q)(n,r).then((function(e){return e.data})).then((function(e){return Object.assign(o,null===e||void 0===e?void 0:e.category),(0,i.OT)(o)})).finally((function(){return c.value=!1})),e.next=6,s.value;case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),r=function(){var r=(0,u.Z)((0,t.Z)().mark((function r(u){var a,l=arguments;return(0,t.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=l.length>1&&void 0!==l[1]?l[1]:{with:[]},o.slug==u||o.id==u){r.next=5;break}return r.next=4,n(u,a);case 4:return r.abrupt("return",r.sent);case 5:if(!e.value){r.next=7;break}return r.abrupt("return",(0,i.OT)(o));case 7:if(s.value){r.next=11;break}return r.next=10,n(u,a);case 10:return r.abrupt("return",r.sent);case 11:return r.next=13,s.value;case 13:return r.abrupt("return",r.sent);case 14:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();return{category:(0,i.OT)(o),isLoading:(0,i.OT)(c),isLoaded:(0,i.OT)(e),promise:(0,i.OT)(s),onGetWhenNotLoaded:r,onGet:n}}},97402:function(e,n,r){r.d(n,{A:function(){return m},ls:function(){return p},rJ:function(){return s}});r(41539);var t=r(43678),u=r(66309),a=r(2262),i=r(66252),l=(0,u._aR)("drafted",{}),o=(0,a.iH)(!1),c=(0,a.iH)(null);function s(e){var n=(0,a.iH)(!!l.value[e]),r=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{services:[],category:null};return o.value=!0,c.value=(0,t.Ue)(r).then((function(e){return e.data})).then((function(r){return n.value=!0,l.value[e]=r.order,(0,a.OT)((0,i.Fl)((function(){return l.value[e]})))})).finally((function(){return o.value=!1})),c.value};return{onCreate:r,isCreated:(0,a.OT)(n),isCreating:(0,a.OT)(o),promise:(0,a.OT)(c),draftedOrders:(0,a.OT)(l),currentDraftedOrder:(0,a.OT)((0,i.Fl)((function(){return l.value[e]})))}}var v=(0,a.iH)(!1),d=(0,a.iH)(!1),f=(0,a.iH)(null);function p(e){var n=function(){var n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{services:[],name:null,description:null,price:null,price_unit:null,price_from:null,price_up_to:null,is_ranged_price:null,started_at:null,ended_at:null,is_online:null,at_executor:null,at_customer:null,exit_locations:null,address:null,lat:null,lng:null};return v.value=!0,d.value=!1,f.value=(0,t.Vx)(null===(n=l.value[e])||void 0===n?void 0:n.id,r).then((function(e){return e.data})).then((function(n){l.value[e]=n.order,d.value=!0})).finally((function(){return v.value=!1})),f.value};return{isUpdated:(0,a.OT)(d),isUpdating:(0,a.OT)(v),promise:(0,a.OT)(f),onUpdate:n,draftedOrders:(0,a.OT)(l),currentDraftedOrder:(0,a.OT)((0,i.Fl)((function(){return l.value[e]})))}}var g=(0,a.iH)(!1),h=(0,a.iH)(null);function m(e){var n=(0,a.iH)(!1),r=function(){var r;return g.value=!0,h.value=(0,t.nY)(null===(r=l.value[e])||void 0===r?void 0:r.id).then((function(e){return e.data})).then((function(e){return null===e||void 0===e?void 0:e.order})).then((function(r){return n.value=!0,delete l.value[e],r})).finally((function(){return g.value=!1}))};return{isPublishing:(0,a.OT)(g),isPublished:(0,a.OT)(n),promise:(0,a.OT)(h),onPublish:r,draftedOrders:(0,a.OT)(l),currentDraftedOrder:(0,a.OT)((0,i.Fl)((function(){return l.value[e]})))}}},20586:function(e,n,r){r.d(n,{Z:function(){return d}});var t=r(50124),u=r(48534),a=(r(41539),r(79166)),i=r(2262),l=(0,i.iH)([]),o=(0,i.iH)(!1),c=(0,i.iH)(null),s=(0,i.iH)(!1),v=(0,i.iH)(null);function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{page:1,perPage:10,search:null,category:null,parent:null,nested:null},n=function(){var n=(0,u.Z)((0,t.Z)().mark((function n(){var r,u,d=arguments;return(0,t.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=d.length>0&&void 0!==d[0]?d[0]:{page:1,perPage:10,search:null,category:null,parent:null,nested:null},o.value=!0,u={},Object.assign(u,e,r),v.value=new AbortController,n.next=7,new Promise((function(e){return setTimeout(e,2e3)}));case 7:return c.value=(0,a.U2)(u,{signal:v.value.signal}).then((function(e){return e.data})).then((function(e){return l.value=e.collection,s.value=!0,(0,i.OT)(l)})).finally((function(){o.value=!1})),n.next=10,c.value;case 10:return n.abrupt("return",n.sent);case 11:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),r=function(){v.value&&v.value.abort()},d=function(){l.value=[],s.value=!1};return{isLoading:(0,i.OT)(o),isLoaded:(0,i.OT)(s),services:(0,i.OT)(l),promise:(0,i.OT)(c),onGet:n,cancel:r,clear:d}}},69722:function(e,n,r){r.d(n,{Z:function(){return l}});var t=r(50124),u=r(48534),a=(r(41539),r(79166)),i=r(2262);function l(){var e=(0,i.iH)(),n=(0,i.iH)(!1),r=(0,i.iH)(!1),l=(0,i.iH)(null),o=function(){var o=(0,u.Z)((0,t.Z)().mark((function u(o){var c,s,v=arguments;return(0,t.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return c=v.length>1&&void 0!==v[1]?v[1]:{with:[],count:[]},s=v.length>2&&void 0!==v[2]?v[2]:{},n.value=!0,l.value=(0,a.Ql)(o,c,s).then((function(e){return e.data})).then((function(n){return e.value=n.service,r.value=!0,(0,i.OT)(e)})).finally((function(){return n.value=!1})),t.next=6,l.value;case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),u)})));return function(e){return o.apply(this,arguments)}}();return{service:(0,i.OT)(e),isLoading:(0,i.OT)(n),isLoaded:(0,i.OT)(r),promise:(0,i.OT)(l),onGet:o}}},59228:function(e,n,r){r.d(n,{Z:function(){return p}});var t=r(66252),u=r(49963),a=r(22201),i=["onSubmit"],l={class:"p-4"},o={class:"px-4 flex-1 min-h-[18rem]"},c={class:"p-4 sticky bottom-0 bg-white flex justify-between z-40 drop-shadow-lg"},s=(0,t.Uk)(" отмена "),v=(0,t.Uk)(" продолжить "),d={__name:"base-form",emits:["onSubmit"],setup:function(e,n){var r=n.emit,d=(0,a.tv)(),f=function(e){return r("onSubmit",e)},p=function(){d.back()};return function(e,n){var r=(0,t.up)("c-button");return(0,t.wg)(),(0,t.iD)("form",{class:"flex flex-col relative w-full min-h-full rounded-lg bg-white shadow shadow-primary/25 overflow-clip",onSubmit:(0,u.iM)(f,["prevent"])},[(0,t._)("div",l,[(0,t.WI)(e.$slots,"header")]),(0,t._)("div",o,[(0,t.WI)(e.$slots,"default")]),(0,t._)("div",c,[(0,t.WI)(e.$slots,"footer",{},(function(){return[(0,t.Wm)(r,{scheme:"secondary",type:"button",onClick:p},{default:(0,t.w5)((function(){return[s]})),_:1}),(0,t.Wm)(r,null,{default:(0,t.w5)((function(){return[v]})),_:1})]}))])],40,i)}}};const f=d;var p=f},60989:function(e,n,r){r.r(n),r.d(n,{default:function(){return P}});var t=r(50124),u=r(48534),a=(r(69826),r(41539),r(66252)),i=r(2262),l=r(3577),o=r(59228),c=r(1875),s=r(97402),v=r(20586),d=r(69722),f=r(54028),p=r(62587),g=r(91296),h=r.n(g),m=r(22201),y={key:0,class:"pt-1.5 pb-0.5"},w=(0,a._)("div",{class:"h-7 w-96 bg-primary/10 rounded-lg animate-pulse"},null,-1),b=[w],_={key:2,class:"pt-1.5 pb-0.5"},x=(0,a._)("div",{class:"h-4 w-64 bg-primary/10 rounded-md animate-pulse"},null,-1),O=[x],k={class:"mb-4"},U=(0,a._)("div",{class:"text-center"}," По вашему запросу услуги не найдены ",-1),Z={key:0,class:"pt-1.5 pb-0.5"},S=(0,a._)("div",{class:"h-4 w-20 bg-primary/10 rounded-md animate-pulse"},null,-1),T=[S],H={key:2,class:"flex gap-4 flex-wrap min-h-[2.375rem] py-3"},C=(0,a.Uk)(" отмена "),D=(0,a.Uk)(" продолжить "),z={__name:"search-form",props:{categorySlug:{}},setup:function(e){var n,r,g,w,x,S,z=e,L=(0,i.BK)(z),P=L.categorySlug,W=(0,m.tv)(),j=(0,c.Z)(),$=j.category,F=j.isLoading,G=j.isLoaded,q=j.onGetWhenNotLoaded;(0,a.bv)((function(){q(P.value,{with:["priority_services","image"]})}));var A=(0,v.Z)({category:P.value,perPage:20}),V=A.services,Y=A.isLoading,I=A.isLoaded,J=A.onGet,K=A.cancel,Q=A.clear;(0,a.Ah)((function(){Q()}));var N=(0,s.rJ)(P.value),R=N.onCreate,B=(N.isCreated,N.isCreating),M=N.currentDraftedOrder,E=(0,s.ls)(P.value),X=(E.isUpdated,E.isUpdating),ee=E.onUpdate,ne=function(e){W.back()},re=(0,i.iH)((null===(n=M.value)||void 0===n||null===(r=n.services)||void 0===r||null===(g=r[0])||void 0===g?void 0:g.slug)||null),te=(0,i.iH)((null===(w=M.value)||void 0===w||null===(x=w.services)||void 0===x||null===(S=x[0])||void 0===S?void 0:S.name)||"");(0,a.YP)(te,(function(){var e,n=(null===$||void 0===$||null===(e=$.priority_services)||void 0===e?void 0:e.find((function(e){return te.value==e.name})))||V.value.find((function(e){return te.value==e.name}));re.value=n?n.slug:null,h()((function(){Y.value&&K(),J({category:$.slug,with:[],search:te.value})}),200)(),ae.service=null}));var ue=function(e){te.value=e.name},ae=(0,i.qj)({}),ie=(0,f.ZP)({service:{required:p.C1}},{service:re},{$externalResults:ae}),le=(0,d.Z)(),oe=le.service,ce=le.onGet,se=le.isLoading,ve=function(){var e=(0,u.Z)((0,t.Z)().mark((function e(n){return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie.value.$validate();case 2:if(e.sent){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,ce(re.value,{count:["children"]});case 6:if(!M.value){e.next=11;break}return e.next=9,ee({services:[re.value]}).catch((function(e){var n=e.response;if(400==n.status){var r=null===n||void 0===n?void 0:n.data,t=r.error;"validation"==t.type&&(ae.service=t.fields.services||[],ae.category=t.fields.category||[])}}));case 9:e.next=13;break;case 11:return e.next=13,R({category:$.slug,services:[re.value]}).catch((function(e){var n=e.response;if(400==n.status){var r=null===n||void 0===n?void 0:n.data,t=r.error;"validation"==t.type&&(ae.service=t.fields.services||[],ae.category=t.fields.category||[])}}));case 13:W.push({name:"order.update",params:{categorySlug:P.value,serviceSlugs:[re.value],form:oe.value.children_count>0?"select":"work-place"}});case 14:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),de=(0,a.Fl)((function(){return F.value||B.value||X.value||se.value}));return function(e,n){var r=(0,a.up)("c-search"),t=(0,a.up)("c-button");return(0,a.wg)(),(0,a.j4)(o.Z,{onOnSubmit:ve},{header:(0,a.w5)((function(){return[(0,i.SU)(F)?((0,a.wg)(),(0,a.iD)("div",y,b)):((0,a.wg)(),(0,a.iD)("h1",{key:1,class:(0,l.C_)(["text-3xl text-primary",{"animate-pulse":(0,i.SU)(de)}])},(0,l.zw)(1==(0,i.SU)($).id?"По какому предмету нужен репетитор?":"Что нужно сделать?"),3)),(0,i.SU)(F)?((0,a.wg)(),(0,a.iD)("div",_,O)):((0,a.wg)(),(0,a.iD)("p",{key:3,class:(0,l.C_)(["text-orange-500",{"animate-pulse":(0,i.SU)(de)}])},(0,l.zw)((0,i.SU)($).name),3))]})),footer:(0,a.w5)((function(){return[(0,a.Wm)(t,{scheme:"secondary",type:"button",onClick:ne,loading:(0,i.SU)(de),disabled:(0,i.SU)(de)},{default:(0,a.w5)((function(){return[C]})),_:1},8,["loading","disabled"]),(0,a.Wm)(t,{loading:(0,i.SU)(de),disabled:(0,i.SU)(de)},{default:(0,a.w5)((function(){return[D]})),_:1},8,["loading","disabled"])]})),default:(0,a.w5)((function(){var e,u;return[(0,a._)("div",k,[(0,a.Wm)(r,{class:(0,l.C_)(["w-full sm:w-2/3",{"animate-pulse":(0,i.SU)(de)}]),disabled:(0,i.SU)(de),placeholder:(0,i.SU)(F)?"":"Услуга или специалист",modelValue:te.value,"onUpdate:modelValue":n[0]||(n[0]=function(e){return te.value=e}),loading:!(0,i.SU)(I),items:(0,i.SU)(V),onOnSelectItem:ue},{"no-items":(0,a.w5)((function(){return[U]})),_:1},8,["class","disabled","placeholder","modelValue","loading","items"]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((0,i.SU)(ie).service.$errors,(function(e){return(0,a.wg)(),(0,a.iD)("div",{class:"text-red-500",key:e.$uid},(0,l.zw)(e.$message),1)})),128))]),(0,i.SU)(F)?((0,a.wg)(),(0,a.iD)("div",Z,T)):(0,i.SU)(G)&&(null===(e=(0,i.SU)($).priority_services)||void 0===e?void 0:e.length)>0?((0,a.wg)(),(0,a.iD)("p",{key:1,class:(0,l.C_)({"animate-pulse":(0,i.SU)(de)})}," Например: ",2)):(0,a.kq)("",!0),(0,i.SU)(G)?((0,a.wg)(),(0,a.iD)("div",H,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((null===(u=(0,i.SU)($))||void 0===u?void 0:u.priority_services)||[],(function(e){return(0,a.wg)(),(0,a.j4)(t,{class:"rounded-full py-1 text-sm",outlined:"",loading:(0,i.SU)(de),disabled:(0,i.SU)(de),key:e.id,type:"button",onClick:function(n){return ue(e)}},{default:(0,a.w5)((function(){return[(0,a.Uk)((0,l.zw)(e.name),1)]})),_:2},1032,["loading","disabled","onClick"])})),128))])):(0,a.kq)("",!0)]})),_:1})}}};const L=z;var P=L}}]);
//# sourceMappingURL=order-form-search-legacy.63b4edcc.js.map